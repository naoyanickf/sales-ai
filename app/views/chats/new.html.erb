<section class="py-4">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-12 col-xl-10">
        <div class="card h-100 shadow-sm">
          <div class="card-header bg-white border-bottom-0">
            <div class="d-flex flex-wrap justify-content-between align-items-center gap-2">
              <div>
                <h2 class="h5 mb-0">AI営業サポート</h2>
              </div>
              <%= link_to "新しいチャットを始める",
                          authenticated_root_path,
                          class: "btn btn-sm btn-outline-secondary" %>
            </div>
          </div>
          <div class="card-body d-flex flex-column">
            <%= turbo_stream_from "#{dom_id(@chat)}_messages" %>
            <div id="<%= dom_id(@chat) %>_messages"
                 class="chat-thread flex-grow-1 overflow-auto mb-3 d-flex flex-column gap-3"
                 data-chat-scroll-container>
              <% if @chat.messages.empty? %>
                <div class="text-center text-muted my-auto">
                  <p class="mb-1">まだメッセージがありません。</p>
                  <p class="mb-0">下のフォームから質問を送信してください。</p>
                </div>
              <% else %>
                <%= render @chat.messages %>
              <% end %>
            </div>
            <%= render "messages/form",
                       chat: @chat,
                       message: @message,
                       products: @products,
                       sales_experts: @sales_experts,
                       available_sales_experts: @available_sales_experts %>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
