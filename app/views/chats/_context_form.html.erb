<%= form_with model: chat,
              url: chat_path(chat),
              method: :patch,
              data: { turbo_frame: dom_id(chat, :context), chat_context_form: true },
              html: { class: "chat-context-inline bg-light border rounded-3 p-3" } do |form| %>
  <div class="row g-3 align-items-end">
    <div class="col-12 col-lg-6">
      <%= form.label :product_id, "製品 (必須)", class: "form-label small fw-semibold text-muted mb-1" %>
      <%= form.collection_select :product_id,
                                 products,
                                 :id,
                                 :name,
                                 { include_blank: "選択してください" },
                                 class: "form-select form-select-sm",
                                 required: true,
                                 data: { chat_context_field: true } %>
    </div>

    <div class="col-12 col-lg-6">
      <%= form.label :sales_expert_id, "相談相手", class: "form-label small fw-semibold text-muted mb-1" %>
      <%= form.collection_select :sales_expert_id,
                                 sales_experts,
                                 :id,
                                 :name,
                                 { include_blank: sales_experts.any? ? "未選択" : "製品を先に選択" },
                                 class: "form-select form-select-sm",
                                 disabled: sales_experts.none?,
                                 data: { chat_context_field: true } %>
    </div>
  </div>
<% end %>
